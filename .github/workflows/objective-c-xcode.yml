name: Build Unsigned macOS App as ZIP

on:
  workflow_dispatch: # manuell startbar

jobs:
  build:
    runs-on: macos-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Build macOS App Unsigned
        run: |
          # Build workspace ohne Signierung
          xcodebuild -workspace PiPifier.xcworkspace \
                     -scheme PiPifier \
                     -configuration Release \
                     -derivedDataPath build \
                     CODE_SIGN_IDENTITY="" \
                     CODE_SIGNING_REQUIRED=NO

      - name: Package App into ZIP
        run: |
          cd build/Build/Products/Release
          zip -r PiPifier-macOS.zip PiPifier.app

      - name: Upload ZIP as Artifact
        uses: actions/upload-artifact@v4
        with:
          name: PiPifier-macOS-ZIP
          path: build/Build/Products/Release/PiPifier-macOS.zip
